<!DOCTYPE html>
<html lang="en";style="height:100%,width:100%";>

<title> Streamline </title>

<head>

<link rel="stylesheet" href="scripts/leaflet/leaflet2.css" />

<style>

#mapid{
  position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
  background: #000000;
}

</style>

</head>

<body>

<div id="mapid"></div>

<script src="https://unpkg.com/leaflet@0.7.7/dist/leaflet.js"></script>

<script>


///////////////////////////////////////
///////// Map details ////////////////
//////////////////////////////////////

var mymap = L.map('mapid').setView([1, 10], 2);

/// Create the map! 

L.tileLayer('newmap/maptiles/{z}/{x}/{y}.png',{
	minZoom: 2,
	maxZoom: 5,
	noWrap:true,
	continuousWorld:false,
}).addTo(mymap);

///testestest///
(function(global){
  var MarkerMixin = {
    _updateZIndex: function (offset) {
      this._icon.style.zIndex = this.options.forceZIndex ? (this.options.forceZIndex + (this.options.zIndexOffset || 0)) : (this._zIndex + offset);
    },
    setForceZIndex: function(forceZIndex) {
      this.options.forceZIndex = forceZIndex ? forceZIndex : null;
    }
  };
  if (global) global.include(MarkerMixin);
})(L.Marker);

///testestest///

////////////////////////////////
///////// CREATE ICONS /////////
////////////////////////////////


///// QUEST ICONS /////
/// Noble Quest Icon
var nobleicon = L.icon({
    iconUrl: 'quest_shield.png',
    iconSize:     [80,80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350] // point from which the popup should open relative to the iconAnchor
});

/// Elf Quest Icon
var elficon = L.icon({
    iconUrl: 'quest_elf.png',
    iconSize:     [80, 80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350] // point from which the popup should open relative to the iconAnchor
});

/// Church Quest Icon
var churchicon = L.icon({
    iconUrl: 'quest_church.png',
    iconSize:     [80, 80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350] // point from which the popup should open relative to the iconAnchor
});

/// Monster Quest Icon
var monstericon = L.icon({
    iconUrl: 'quest_monster.png',
    iconSize:     [80, 80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350] // point from which the popup should open relative to the iconAnchor
});

/// Dwarf Quest Icon
var dwarficon = L.icon({
    iconUrl: 'quest_dwarf.png',
    iconSize:     [80, 80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350],
    riseOnHover: true,
    forceZIndex: 2 // point from which the popup should open relative to the iconAnchor
});

///// PLACE ICONS /////
/// Black Castle Icon
var castleicon = L.icon({
    iconUrl: 'castleicon.png',
    iconSize:     [60, 60], // size of the icon
    iconAnchor:   [30, 30],
    popupAnchor:  [175, 350],
    forceZIndex: 1 // point from which the popup should open relative to the iconAnchor
});

/// Large Castle Icon
var whcastleicon = L.icon({
    iconUrl: 'whcastleicon.png',
    iconSize:     [80, 80], // size of the icon
    iconAnchor:   [40, 40],
    popupAnchor:  [175, 350],
    forceZIndex: 1 // point from which the popup should open relative to the iconAnchor
});

/// Church Icon
var churchplace = L.icon({
    iconUrl: 'churchicon.png',
    iconSize:     [56, 60], // size of the icon
    iconAnchor:   [28, 30],
    popupAnchor:  [175, 350],
    forceZIndex: 1 // point from which the popup should open relative to the iconAnchor
});

///words///


/////////////////////////////////////////////////
///////// Set icon and co-ord for marks /////////
/////////////////////////////////////////////////

var cordmarker = L.marker([-58.44773, -94.21875],{
    icon: churchicon,
    draggable: true,
});

cordmarker.on('dragend', function(e){
    alert(cordmarker.getLatLng().toString());
}).addTo(mymap);



/////////////////////////////////////////
///////// Create CASTLE markers /////////
////////////////////////////////////////


        var castle1 = L.marker([-52.9354, -0.08789],{icon: castleicon});
        var castle2 = L.marker([-53.51418, 10.2832],{icon: whcastleicon});
        var castle3 = L.marker([-48.77791, 18.76465],{icon: churchplace});
        var castle4 = L.marker([-44.33957, 0.79102],{icon: castleicon});
        var castle5 = L.marker([-55.72711, 25.00488],{icon: castleicon});
        var castle6 = L.marker([-64.32087, 18.58887],{icon: whcastleicon});
        var castle7 = L.marker([-61.58549, 28.38867],{icon: castleicon});

        var castleMarkers = L.featureGroup();

        var j = 1;

        while (j < 8) {
            var currentCastle = window['castle' + j];
            currentCastle.addTo(castleMarkers);
            j++;
        }




/////////////////////////////////////////////////////
///////// Shows markers only when zoomed in /////////
/////////////////////////////////////////////////////

castleMarkers.addLayer(castle1);

mymap.on('zoomend', function() {
    if (mymap.getZoom() < 3){
            mymap.removeLayer(castleMarkers);

    }
    else {
            mymap.addLayer(castleMarkers);
        }
});

mymap.on('zoomend', function() {
    if (mymap.getZoom() > 3){
            mymap.addLayer(castleMarkers);
    }
    else {
            mymap.removeLayer(castleMarkers);
        }
});


////////////////////////////////////////
///////// Create QUEST markers /////////
////////////////////////////////////////

        var quest1 = L.marker([-53.67068, 10.2832],{icon: nobleicon,riseOnHover: true}); 
        var quest2 = L.marker([-56.18002, 2.25121],{icon: elficon,riseOnHover: true}); 
        var quest3 = L.marker([-49.52521, 18.80859],{icon: churchicon,riseOnHover: true}); 
        var quest4 = L.marker([-43.71759, 11.34789],{icon: monstericon,riseOnHover: true});
        var quest5 = L.marker([-53.40953, -0.08789],{icon: dwarficon,riseOnHover: true}); 

        var questMarkers = L.featureGroup();
        var i = 1;

        while (i < 6) {
            var currentQuest = window['quest' + i];
            currentQuest.addTo(questMarkers);
            i++;
        }


//Binding quest popups
quest1.bindPopup("<img src='" + "partyq.png" + "' width=400/>");
quest2.bindPopup("<img src='" + "elfq.png" + "' width=400/>");
quest3.bindPopup("<img src='" + "churchq.png" + "' width=400/>");
quest4.bindPopup("<img src='" + "monsterq.png" + "' width=400/>");
quest5.bindPopup("<img src='" + "dwarfq.png" + "' width=400/>");



var cordmarkerMarker = L.featureGroup();


var dataLayers = {
    "Quests": questMarkers,
};



L.control.layers(null,dataLayers,{collapsed: false}).addTo(mymap);




</script>

</body>

</html>
